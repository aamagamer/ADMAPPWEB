<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Portal de Administrador</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css"
      rel="stylesheet"
    />

    <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>

    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        font-family: "Arial", sans-serif;
      }

      body {
        background-color: #f5f5f5;
        color: #333;
      }

      header {
        background-color: #2c3e50;
        color: white;
        padding: 40px 0;
        height: 180px;
        display: flex;
        align-items: center;
      }

      .header-container {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        max-width: 1200px;
        margin: 0 auto;
        padding: 0 20px;
        width: 100%;
      }

      .logo {
        width: 50%;
        height: 25%;
        margin-bottom: 15px;
        max-height: 25%;
        max-width: 25%;
      }

      h1 {
        font-size: 28px;
        font-weight: 600;
        text-align: center;
      }

      .welcome-section {
        text-align: center;
        margin: 30px auto;
      }

      .welcome-message {
        font-size: 32px;
        color: #2c3e50;
        margin-bottom: 10px;
      }

      .content-wrapper {
        display: flex;
        justify-content: space-between;
        max-width: 1200px;
        margin: 0 auto;
        padding: 0 20px;
        gap: 30px;
      }

      .employee-table-container {
        flex: 7;
      }

      .employee-table-container h2 {
        margin-bottom: 15px;
        color: #2c3e50;
        display: flex;
        justify-content: space-between;
        align-items: center;
      }

      .employee-table {
        width: 100%;
        border-collapse: collapse;
        background-color: white;
        border-radius: 8px;
        box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
        overflow: hidden;
      }

      .employee-table th,
      .employee-table td {
        padding: 10px;
        text-align: left;
        border-bottom: 1px solid #ddd;
      }

      .employee-table th {
        background-color: #2c3e50;
        color: white;
      }

      .options-container {
        flex: 2.5;
        display: grid;
        grid-template-columns: 1fr;
        gap: 12px;
      }

      .option-button {
        background-color: white;
        border: none;
        border-radius: 8px;
        box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        transition: all 0.3s ease;
        padding: 10px;
        height: 100px;
        color: inherit;
        text-align: center;
      }

      .option-button:hover {
        transform: translateY(-3px);
        box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
      }

      .option-button h2 {
        font-size: 14px;
        color: #2c3e50;
        margin-bottom: 4px;
      }

      .option-button p {
        color: #666;
        font-size: 12px;
      }

      .option-button div::before {
        font-size: 24px;
        display: block;
        margin-bottom: 4px;
      }

      .action-btn {
        background: none;
        border: none;
        cursor: pointer;
        font-size: 16px;
        margin: 0 2px;
        padding: 3px;
      }

      .modal {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.6);
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 999;
        animation: fadeIn 0.3s ease;
      }

      .modal-content {
        background: white;
        padding: 25px 30px;
        width: 90%;
        max-width: 850px;
        border-radius: 12px;
        position: relative;
        animation: slideIn 0.3s ease;
        box-shadow: 0 15px 25px rgba(0, 0, 0, 0.2);
      }

      .modal-content h2 {
        margin-bottom: 20px;
        color: #2c3e50;
        font-size: 24px;
        border-bottom: 2px solid #2c3e50;
        padding-bottom: 10px;
      }

      .modal-content span.close {
        position: absolute;
        top: 15px;
        right: 20px;
        font-size: 30px;
        font-weight: bold;
        color: #aaa;
        cursor: pointer;
        transition: color 0.3s ease;
      }

      .modal-content span.close:hover {
        color: #e74c3c;
      }
      .hidden {
        display: none;
      }

      #modal-body {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 12px;
        margin-top: 15px;
        align-items: start;
      }

      #modal-body p {
        background: #f9f9f9;
        padding: 10px 12px;
        border-left: 4px solid #2c3e50;
        border-radius: 6px;
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
        font-size: 13px;
        line-height: 1.4;
        margin: 0;
        word-break: break-word;
      }

      #modal-body strong {
        display: block;
        font-weight: bold;
        margin-bottom: 3px;
        color: #2c3e50;
        font-size: 13px;
      }

      /* Estilos para el modal de alta de empleado */
      .add-employee-modal {
        max-width: 900px;
        max-height: 90vh;
        overflow-y: auto;
      }

      .add-employee-form {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
        gap: 15px;
      }

      .form-group {
        margin-bottom: 10px;
      }

      .form-group label {
        display: block;
        margin-bottom: 5px;
        font-weight: bold;
        color: #2c3e50;
        font-size: 14px;
      }

      .form-group input,
      .form-group select {
        width: 100%;
        padding: 8px 10px;
        border: 1px solid #ddd;
        border-radius: 4px;
        font-size: 14px;
      }

      .form-group select {
        appearance: none;
        background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6 9 12 15 18 9'%3e%3c/polyline%3e%3c/svg%3e");
        background-repeat: no-repeat;
        background-position: right 10px center;
        background-size: 15px;
      }

      .form-actions {
        grid-column: 1 / -1;
        display: flex;
        justify-content: flex-end;
        gap: 10px;
        margin-top: 20px;
      }

      .btn {
        padding: 8px 15px;
        border-radius: 4px;
        cursor: pointer;
        font-size: 14px;
        transition: all 0.3s ease;
      }

      .btn-primary {
        background-color: #2c3e50;
        color: white;
        border: none;
      }

      .btn-primary:hover {
        background-color: #1a252f;
      }

      .btn-secondary {
        background-color: #f5f5f5;
        color: #333;
        border: 1px solid #ddd;
      }

      .btn-secondary:hover {
        background-color: #e0e0e0;
      }

      .add-employee-btn {
        background-color: #2c3e50;
        color: white;
        border: none;
        padding: 8px 15px;
        border-radius: 4px;
        cursor: pointer;
        font-size: 14px;
        transition: all 0.3s ease;
      }

      .add-employee-btn:hover {
        background-color: #1a252f;
      }

      /* Estilos para el modal de exportación */
      #export-fields-container {
        max-height: 400px;
        overflow-y: auto;
        padding: 10px;
      }

      #export-fields-container div {
        padding: 8px;
        background: #f9f9f9;
        border-radius: 4px;
      }

      #export-fields-container input[type="checkbox"] {
        margin-right: 8px;
      }

      .modal-confirmacion {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.5);
        display: flex;
        justify-content: center;
        align-items: center;
        z-index: 1000;
      }

      .modal-confirmacion.hidden {
        display: none;
      }

      .modal-contenido {
        background: white;
        padding: 20px 30px;
        border-radius: 8px;
        max-width: 400px;
        text-align: center;
        box-shadow: 0 4px 10px rgba(0, 0, 0, 0.25);
      }

      .modal-botones {
        margin-top: 20px;
        display: flex;
        justify-content: space-around;
      }

      .btn {
        padding: 8px 20px;
        border: none;
        border-radius: 5px;
        cursor: pointer;
        font-weight: bold;
      }

      .btn-danger {
        background-color: #e74c3c;
        color: white;
      }

      .btn:hover {
        opacity: 0.9;
      }

      

      @keyframes fadeIn {
        from {
          opacity: 0;
        }
        to {
          opacity: 1;
        }
      }

      @keyframes slideIn {
        from {
          opacity: 0;
          transform: translateY(-20px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      @media (max-width: 768px) {
        .content-wrapper {
          flex-direction: column;
        }

        .modal-content {
          padding: 20px;
          width: 95%;
        }

        #modal-body {
          grid-template-columns: 1fr;
        }
      }
    </style>
  </head>
  <body>
    <header>
      <div class="header-container">
        <img src="Media/logo.png" alt="Logo" class="logo" />
        <h1>Portal De Administrador</h1>
      </div>
    </header>

    <div class="welcome-section">
      <div class="welcome-message">
        ¡Hola <span id="employee-name">Juan Pérez</span>!
      </div>
      <p>¿Qué deseas hacer hoy?</p>
    </div>

    <div class="content-wrapper">
      <div class="employee-table-container">
        <h2>
          Empleados Registrados
          <button class="add-employee-btn" onclick="abrirModalAltaEmpleado()">
            Agregar empleado +
          </button>

          <button
            class="add-employee-btn"
            onclick="abrirModalExportarExcel()"
            style="margin-left: 2px"
          >
            Exportar Excel +
          </button>
        </h2>

        <div
          style="
            display: flex;
            justify-content: flex-end;
            align-items: center;
            margin-bottom: 10px;
          "
        >
          <input
            type="text"
            id="busquedaEmpleado"
            oninput="buscarEmpleado()"
            placeholder="Buscar por ID o nombre"
            style="
              padding: 8px;
              width: 250px;
              margin-right: 8px;
              border-radius: 4px;
              border: 1px solid #ccc;
            "
          />
          <button
            onclick="buscarEmpleado()"
            style="
              background-color: #2c3e50;
              color: white;
              padding: 8px 12px;
              border: none;
              border-radius: 4px;
              cursor: pointer;
            "
          >
            <i class="bi bi-search"></i>
          </button>
        </div>

        <table class="employee-table">
          <thead>
            <tr>
              <th>Número</th>
              <th>Nombre</th>
              <th>Puesto</th>
              <th>Acciones</th>
            </tr>
          </thead>
          <tbody id="empleados-body"></tbody>
        </table>
      </div>
      <div class="options-container">
        <a href="pendiente.html" class="option-button">
          <i class="bi bi-search" style="font-size: 24px"></i>
          <h2>Revisar</h2>
          <p>Solicitudes</p>
        </a>

        <a href="pendiente.html" class="option-button">
          <i class="bi bi-hospital" style="font-size: 24px"></i>
          <h2>Incapacidades</h2>
          <p>Autorizaciones</p>
        </a>

        <a href="pendiente.html" class="option-button">
          <i class="bi bi-person-plus" style="font-size: 24px"></i>
          <h2>Agregar Rol</h2>
          <p>Nuevos roles</p>
        </a>

        <a href="pendiente.html" class="option-button">
          <i class="bi bi-bar-chart-line" style="font-size: 24px"></i>
          <h2>Reportes</h2>
          <p>Ver</p>
        </a>

        <a href="pendiente.html" class="option-button">
          <i class="bi bi-building" style="font-size: 24px"></i>
          <h2>Área</h2>
          <p>Agregar</p>
        </a>

        <a href="pendiente.html" class="option-button">
          <i class="bi bi-pin-map" style="font-size: 24px"></i>
          <h2>Vacante</h2>
          <p>Administra</p>
        </a>
      </div>
    </div>

    <!-- Modal para ver detalles del empleado -->
    <div id="modal" class="modal hidden">
      <div class="modal-content">
        <span class="close" onclick="cerrarModal()">&times;</span>
        <h2>Detalle del Empleado</h2>
        <div id="modal-body"></div>
      </div>
    </div>

    <!-- Modal para dar de alta empleado -->
    <div id="add-employee-modal" class="modal hidden">
      <div class="modal-content add-employee-modal">
        <span class="close" onclick="cerrarModalAltaEmpleado()">&times;</span>
        <h2>Dar de alta nuevo empleado</h2>
        <form id="employee-form" class="add-employee-form">
          <!-- Campo 1 -->
          <div class="form-group">
            <label for="idUsuario">ID Usuario:</label>
            <input type="number" id="idUsuario" name="idUsuario" required />
          </div>

          <!-- Campo 2 (Combobox) -->
          <div class="form-group">
            <label for="tipoRol">Tipo de Rol:</label>
            <select id="tipoRol" name="tipoRol" required>
              <option value="">Cargando roles...</option>
            </select>
          </div>

          <!-- Campo 3 (Combobox) -->
          <div class="form-group">
            <label for="nombreArea">Área:</label>
            <select id="nombreArea" name="nombreArea" required>
              <option value="">Cargando áreas...</option>
            </select>
          </div>

          <!-- Campo 4 -->
          <div class="form-group">
            <label for="nombres">Nombres:</label>
            <input type="text" id="nombres" name="nombres" required />
          </div>

          <!-- Campo 5 -->
          <div class="form-group">
            <label for="paterno">Apellido Paterno:</label>
            <input type="text" id="paterno" name="paterno" required />
          </div>

          <!-- Campo 6 -->
          <div class="form-group">
            <label for="materno">Apellido Materno:</label>
            <input type="text" id="materno" name="materno" />
          </div>

          <!-- Campo 7 -->
          <div class="form-group">
            <label for="fechaNacimiento">Fecha de Nacimiento:</label>
            <input
              type="date"
              id="fechaNacimiento"
              name="fechaNacimiento"
              required
            />
          </div>

          <!-- Campo 8 -->
          <div class="form-group">
            <label for="direccion">Dirección:</label>
            <input type="text" id="direccion" name="direccion" required />
          </div>

          <!-- Campo 9 -->
          <div class="form-group">
            <label for="codigoPostal">Código Postal:</label>
            <input type="text" id="codigoPostal" name="codigoPostal" required />
          </div>

          <!-- Campo 10 -->
          <div class="form-group">
            <label for="correo">Correo Electrónico:</label>
            <input type="email" id="correo" name="correo" required />
          </div>

          <!-- Campo 11 -->
          <div class="form-group">
            <label for="nss">Número de Seguro Social (NSS):</label>
            <input type="text" id="nss" name="nss" required />
          </div>

          <!-- Campo 12 -->
          <div class="form-group">
            <label for="telefono">Teléfono:</label>
            <input type="tel" id="telefono" name="telefono" required />
          </div>

          <!-- Campo 13 -->
          <div class="form-group">
            <label for="fechaIngreso">Fecha de Ingreso:</label>
            <input type="date" id="fechaIngreso" name="fechaIngreso" required />
          </div>

          <!-- Campo 14 -->
          <div class="form-group">
            <label for="rfc">RFC:</label>
            <input type="text" id="rfc" name="rfc" required />
          </div>

          <!-- Campo 15 -->
          <div class="form-group">
            <label for="curp">CURP:</label>
            <input type="text" id="curp" name="curp" required />
          </div>

          <!-- Campo 16 -->
          <div class="form-group">
            <label for="puesto">Puesto:</label>
            <input type="text" id="puesto" name="puesto" required />
          </div>

          <!-- Campo 17 -->
          <div class="form-group">
            <label for="nombreContactoEmergencia"
              >Nombre Contacto Emergencia:</label
            >
            <input
              type="text"
              id="nombreContactoEmergencia"
              name="nombreContactoEmergencia"
              required
            />
          </div>

          <!-- Campo 18 -->
          <div class="form-group">
            <label for="telefonoEmergencia">Teléfono Emergencia:</label>
            <input
              type="tel"
              id="telefonoEmergencia"
              name="telefonoEmergencia"
              required
            />
          </div>

          <!-- Campo 19 -->
          <div class="form-group">
            <label for="parentesco">Parentesco:</label>
            <input type="text" id="parentesco" name="parentesco" required />
          </div>

          <!-- Campo 20 -->
          <div class="form-group">
            <label for="contraseña">Contraseña:</label>
            <input type="password" id="contraseña" name="contraseña" required />
          </div>

          <!-- Campo 21 -->
          <div class="form-group">
            <label for="confirmarContraseña">Confirmar Contraseña:</label>
            <input
              type="password"
              id="confirmarContraseña"
              name="confirmarContraseña"
              required
            />
          </div>

          <!-- Campo Sueldo Diario -->
          <div class="form-group">
            <label for="sueldoDiario">Sueldo Diario:</label>
            <input
              type="number"
              id="sueldoDiario"
              name="SueldoDiario"
              required
            />
          </div>

          <!-- Campo Sueldo Semanal -->
          <div class="form-group">
            <label for="sueldoSemanal">Sueldo Semanal:</label>
            <input
              type="number"
              id="sueldoSemanal"
              name="SueldoSemanal"
              required
            />
          </div>

          <!-- Campo Bono Semanal -->
          <div class="form-group">
            <label for="bonoSemanal">Bono Semanal:</label>
            <input type="number" id="bonoSemanal" name="BonoSemanal" required />
          </div>

          <div class="form-actions">
            <button
              type="button"
              class="btn btn-secondary"
              onclick="cerrarModalAltaEmpleado()"
            >
              Cancelar
            </button>
            <button type="submit" class="btn btn-primary">
              Guardar Empleado
            </button>
          </div>
        </form>
      </div>
    </div>

    <!-- Modal para editar empleado -->
    <div id="edit-employee-modal" class="modal hidden">
      <div class="modal-content add-employee-modal">
        <span class="close" onclick="cerrarModalEditarEmpleado()">&times;</span>
        <h2>Editar Empleado</h2>
        <form id="edit-employee-form" class="add-employee-form">
          <!-- Campo 1 -->
          <div class="form-group">
            <label for="edit-idUsuario">ID Usuario:</label>
            <input type="number" id="edit-idUsuario" name="idUsuario" />
          </div>

          <!-- Campo 2 -->
          <div class="form-group">
            <label for="edit-tipoRol">Tipo de Rol:</label>
            <select id="edit-tipoRol" name="tipoRol" required>
              <option value="">Cargando roles...</option>
            </select>
          </div>

          <!-- Campo 3 -->
          <div class="form-group">
            <label for="edit-nombreArea">Área:</label>
            <select id="edit-nombreArea" name="nombreArea" required>
              <option value="">Cargando áreas...</option>
            </select>
          </div>

          <!-- Campo 4 -->
          <div class="form-group">
            <label for="edit-nombres">Nombres:</label>
            <input type="text" id="edit-nombres" name="nombres" required />
          </div>

          <!-- Campo 5 -->
          <div class="form-group">
            <label for="edit-paterno">Apellido Paterno:</label>
            <input type="text" id="edit-paterno" name="paterno" required />
          </div>

          <!-- Campo 6 -->
          <div class="form-group">
            <label for="edit-materno">Apellido Materno:</label>
            <input type="text" id="edit-materno" name="materno" />
          </div>

          <!-- Campo 7 -->
          <div class="form-group">
            <label for="edit-fechaNacimiento">Fecha de Nacimiento:</label>
            <input
              type="date"
              id="edit-fechaNacimiento"
              name="fechaNacimiento"
              required
            />
          </div>

          <!-- Campo 8 -->
          <div class="form-group">
            <label for="edit-direccion">Dirección:</label>
            <input type="text" id="edit-direccion" name="direccion" required />
          </div>

          <!-- Campo 9 -->
          <div class="form-group">
            <label for="edit-codigoPostal">Código Postal:</label>
            <input
              type="text"
              id="edit-codigoPostal"
              name="codigoPostal"
              required
            />
          </div>

          <!-- Campo 10 -->
          <div class="form-group">
            <label for="edit-correo">Correo Electrónico:</label>
            <input type="email" id="edit-correo" name="correo" required />
          </div>

          <!-- Campo 11 -->
          <div class="form-group">
            <label for="edit-nss">Número de Seguro Social (NSS):</label>
            <input type="text" id="edit-nss" name="nss" required />
          </div>

          <!-- Campo 12 -->
          <div class="form-group">
            <label for="edit-telefono">Teléfono:</label>
            <input type="tel" id="edit-telefono" name="telefono" required />
          </div>

          <!-- Campo 13 -->
          <div class="form-group">
            <label for="edit-fechaIngreso">Fecha de Ingreso:</label>
            <input
              type="date"
              id="edit-fechaIngreso"
              name="fechaIngreso"
              required
            />
          </div>

          <!-- Campo 14 -->
          <div class="form-group">
            <label for="edit-rfc">RFC:</label>
            <input type="text" id="edit-rfc" name="rfc" required />
          </div>

          <!-- Campo 15 -->
          <div class="form-group">
            <label for="edit-curp">CURP:</label>
            <input type="text" id="edit-curp" name="curp" required />
          </div>

          <!-- Campo 16 -->
          <div class="form-group">
            <label for="edit-puesto">Puesto:</label>
            <input type="text" id="edit-puesto" name="puesto" required />
          </div>

          <!-- Campo 17 -->
          <div class="form-group">
            <label for="edit-nombreContactoEmergencia"
              >Nombre Contacto Emergencia:</label
            >
            <input
              type="text"
              id="edit-nombreContactoEmergencia"
              name="nombreContactoEmergencia"
              required
            />
          </div>

          <!-- Campo 18 -->
          <div class="form-group">
            <label for="edit-telefonoEmergencia">Teléfono Emergencia:</label>
            <input
              type="tel"
              id="edit-telefonoEmergencia"
              name="telefonoEmergencia"
              required
            />
          </div>

          <!-- Campo 19 -->
          <div class="form-group">
            <label for="edit-parentesco">Parentesco:</label>
            <input
              type="text"
              id="edit-parentesco"
              name="parentesco"
              required
            />
          </div>

          <!-- Campo 20 -->
          <div class="form-group">
            <label for="edit-contraseña">Contraseña:</label>
            <input
              type="password"
              id="edit-contraseña"
              name="contraseña"
              required
            />
          </div>

          <!-- Campo 21 -->
          <div class="form-group">
            <label for="edit-confirmarContraseña">Confirmar Contraseña:</label>
            <input
              type="password"
              id="edit-confirmarContraseña"
              name="confirmarContraseña"
              required
            />
          </div>

          <!-- Campo Sueldo Diario -->
          <div class="form-group">
            <label for="edit-sueldoDiario">Sueldo Diario:</label>
            <input
              type="number"
              id="edit-sueldoDiario"
              name="SueldoDiario"
              required
            />
          </div>

          <!-- Campo Sueldo Semanal -->
          <div class="form-group">
            <label for="edit-sueldoSemanal">Sueldo Semanal:</label>
            <input
              type="number"
              id="edit-sueldoSemanal"
              name="SueldoSemanal"
              required
            />
          </div>

          <!-- Campo Bono Semanal -->
          <div class="form-group">
            <label for="edit-bonoSemanal">Bono Semanal:</label>
            <input
              type="number"
              id="edit-bonoSemanal"
              name="BonoSemanal"
              required
            />
          </div>

          <!-- Campo Fecha de Baja -->
          <div class="form-group">
            <label for="edit-fechaBaja">Fecha de Baja:</label>
            <input type="date" id="edit-fechaBaja" name="fechaBaja" />
          </div>

          <!-- Campo Comentario de Salida -->
          <div class="form-group">
            <label for="edit-comentarioSalida">Comentario de Salida:</label>
            <input
              type="text"
              id="edit-comentarioSalida"
              name="comentarioSalida"
            />
          </div>

          <!-- Botones -->
          <div class="form-actions">
            <button
              type="button"
              class="btn btn-secondary"
              onclick="cerrarModalEditarEmpleado()"
            >
              Cancelar
            </button>
            <button type="submit" class="btn btn-primary">
              Actualizar Empleado
            </button>
          </div>
        </form>
      </div>
    </div>

    <!-- Modal para exportar a Excel -->
    <div id="export-excel-modal" class="modal hidden">
      <div class="modal-content add-employee-modal">
        <span class="close" onclick="cerrarModalExportarExcel()">&times;</span>
        <h2>Exportar datos a Excel</h2>
        <div id="export-excel-body">
          <p>Selecciona los campos que deseas incluir en el reporte:</p>
          <div
            id="export-fields-container"
            style="
              display: grid;
              grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
              gap: 10px;
              margin-top: 20px;
            "
          ></div>
          <div class="form-actions" style="margin-top: 20px">
            <button
              type="button"
              class="btn btn-secondary"
              onclick="cerrarModalExportarExcel()"
            >
              Cancelar
            </button>
            <button
              type="button"
              class="btn btn-primary"
              onclick="exportarExcel()"
            >
              Generar Excel
            </button>
          </div>
        </div>
      </div>
    </div>

    <div id="modal-confirmacion" class="modal-confirmacion hidden">
      <div class="modal-contenido">
        <p id="modal-texto">¿Quieres eliminar este empleado?</p>
        <div class="modal-botones">
          <button id="modal-cancelar" class="btn">Cancelar</button>
          <button id="modal-confirmar" class="btn btn-danger">Eliminar</button>
        </div>
      </div>
    </div>

    <div id="modal-confirmacion" class="modal-confirmacion hidden">
  <div class="modal-contenido">
    <p id="modal-texto">¿Quieres eliminar este empleado?</p>
    <div class="modal-botones">
      <button id="modal-cancelar" class="btn">Cancelar</button>
      <button id="modal-confirmar" class="btn btn-danger">Eliminar</button>
    </div>
  </div>
</div>

<div id="modal-exito" class="modal-exito hidden">
  <div class="modal-contenido-exito">
    <p>Actualización correcta</p>
    <button id="btn-cerrar-exito" class="btn btn-primary">Aceptar</button>
  </div>
</div>


    <script>

      
      

      // Cargar lista de empleados
      fetch("/api/empleados")
        .then((response) => response.json())
        .then((data) => {
          const tbody = document.getElementById("empleados-body");
          tbody.innerHTML = "";
          data.forEach((emp) => {
            const row = document.createElement("tr");
            row.innerHTML = `
          <td>${emp.id}</td>
          <td>${emp.nombre}</td>
          <td>${emp.puesto}</td>
          <td>
            <button class="action-btn" onclick="verEmpleado(${emp.id})">
  <i class="bi bi-eye"></i>
</button>
<button class="action-btn" onclick="editarEmpleado(${emp.id})">
  <i class="bi bi-pencil"></i>
</button>
<button class="action-btn" onclick="eliminarEmpleado(${emp.id})">
  <i class="bi bi-trash"></i>
</button>

          </td>
        `;
            tbody.appendChild(row);
          });
        })
        .catch((error) => {
          console.error("Error al cargar empleados:", error);
        });

      function verEmpleado(id) {
        fetch(`/api/empleado/${id}`)
          .then((res) => {
            if (!res.ok) throw new Error("Error al cargar datos del empleado");
            return res.json();
          })
          .then((data) => {
            const modalBody = document.getElementById("modal-body");

            const renderField = (label, value) => {
              const texto =
                value === null ||
                value === undefined ||
                value === "" ||
                value === "null"
                  ? "Sin información"
                  : value;
              return `<p><strong>${label}:</strong> ${texto}</p>`;
            };

            modalBody.innerHTML = `
        ${renderField("ID", data.idUsuario)}
        ${renderField("Rol", data.TipoRol)}
        ${renderField("Área", data.NombreArea)}
        ${renderField(
          "Nombre Completo",
          `${data.Nombres} ${data.Paterno} ${data.Materno}`
        )}
        ${renderField("Fecha Nacimiento", data.FechaNacimiento)}
        ${renderField("Dirección", data.Direccion)}
        ${renderField("Código Postal", data.CodigoPostal)}
        ${renderField("Correo", data.Correo)}
        ${renderField("NSS", data.NSS)}
        ${renderField("Teléfono", data.Telefono)}
        ${renderField("Fecha Ingreso", data.FechaIngreso)}
        ${renderField("RFC", data.RFC)}
        ${renderField("CURP", data.Curp)}
        ${renderField("Puesto", data.Puesto)}
        ${renderField("Contacto Emergencia", data.NombreContactoEmergencia)}
        ${renderField("Teléfono Emergencia", data.TelefonoEmergencia)}
        ${renderField("Parentesco", data.Parentesco)}
        ${renderField("Fecha Baja", data.FechaBaja)}
        ${renderField("Comentario Salida", data.ComentarioSalida)}
        ${renderField("Estado", data.Estado)}
        ${renderField("Sueldo Diario", data.SueldoDiario)}
        ${renderField("Sueldo Semanal", data.SueldoSemanal)}
        ${renderField("Bono Semanal", data.BonoSemanal)}
      `;

            document.getElementById("modal").classList.remove("hidden");
          })
          .catch((error) => {
            console.error("Error:", error);
            alert("Error al cargar los datos del empleado");
          });
      }

      function cerrarModal() {
        document.getElementById("modal").classList.add("hidden");
      }

      function abrirModalAltaEmpleado() {
        document
          .getElementById("add-employee-modal")
          .classList.remove("hidden");

        // Llenar roles
        fetch("/api/roles")
          .then((res) => res.json())
          .then((data) => {
            const selectRol = document.getElementById("tipoRol");
            selectRol.innerHTML = '<option value="">Seleccione un rol</option>';
            data.forEach((rol) => {
              const option = document.createElement("option");
              option.value = rol.idRol;
              option.textContent = rol.TipoRol;
              selectRol.appendChild(option);
            });
          });

        // Llenar áreas
        fetch("/api/areas")
          .then((res) => res.json())
          .then((data) => {
            const selectArea = document.getElementById("nombreArea");
            selectArea.innerHTML =
              '<option value="">Seleccione un área</option>';
            data.forEach((area) => {
              const option = document.createElement("option");
              option.value = area.idArea;
              option.textContent = area.NombreArea;
              selectArea.appendChild(option);
            });
          });
      }

      function cerrarModalAltaEmpleado() {
        document.getElementById("add-employee-modal").classList.add("hidden");
      }
      function eliminarEmpleado(id) {
        const modal = document.getElementById("modal-confirmacion");
        const modalTexto = document.getElementById("modal-texto");
        const btnConfirmar = document.getElementById("modal-confirmar");
        const btnCancelar = document.getElementById("modal-cancelar");

        modalTexto.textContent = `¿Estás seguro de que deseas eliminar al empleado con ID ${id}?`;

        modal.classList.remove("hidden");

        // Limpiar eventos previos para evitar acumulación
        btnConfirmar.onclick = null;
        btnCancelar.onclick = null;

        btnConfirmar.onclick = () => {
          fetch(`/api/empleado/${id}`, { method: "DELETE" })
            .then((res) => {
              if (!res.ok) throw new Error("Error al eliminar empleado");
              //alert("Empleado eliminado correctamente");
              location.reload();
            })
            .catch((error) => {
              console.error("Error:", error);
              alert("Error al eliminar el empleado");
            })
            .finally(() => {
              modal.classList.add("hidden");
            });
        };

        btnCancelar.onclick = () => {
          modal.classList.add("hidden");
        };
      }

      document
        .getElementById("employee-form")
        .addEventListener("submit", function (e) {
          e.preventDefault();

          const contraseña = document.getElementById("contraseña").value;
          const confirmarContraseña = document.getElementById(
            "confirmarContraseña"
          ).value;

          if (contraseña !== confirmarContraseña) {
            alert("Las contraseñas no coinciden");
            return;
          }

          const formData = new FormData(this);
          const empleadoData = {};
          formData.forEach((value, key) => {
            empleadoData[key] = value;
          });

          // Mapear tipoRol y nombreArea a rol_id y area_id
          empleadoData.rol_id = empleadoData.tipoRol;
          empleadoData.area_id = empleadoData.nombreArea;
          delete empleadoData.tipoRol;
          delete empleadoData.nombreArea;

          // Convertir números
          empleadoData.idUsuario = Number(empleadoData.idUsuario);
          empleadoData.nss = Number(empleadoData.nss);
          empleadoData.telefono = Number(empleadoData.telefono);
          empleadoData.telefonoEmergencia = Number(
            empleadoData.telefonoEmergencia
          );
          empleadoData.SueldoDiario = Number(empleadoData.SueldoDiario);
          empleadoData.SueldoSemanal = Number(empleadoData.SueldoSemanal);
          empleadoData.BonoSemanal = Number(empleadoData.BonoSemanal);

          if (
            isNaN(empleadoData.idUsuario) ||
            isNaN(empleadoData.nss) ||
            isNaN(empleadoData.telefono) ||
            isNaN(empleadoData.telefonoEmergencia) ||
            isNaN(empleadoData.SueldoDiario) ||
            isNaN(empleadoData.SueldoSemanal) ||
            isNaN(empleadoData.BonoSemanal)
          ) {
            alert(
              "Por favor, ingresa valores numéricos válidos en ID Usuario, NSS, Teléfonos y Sueldos"
            );
            return;
          }

          fetch("/api/empleado", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify(empleadoData),
          })
            .then((res) => {
              if (!res.ok)
                return res.json().then((data) => {
                  throw new Error(data.error || "Error al guardar el empleado");
                });
              return res.json();
            })
            .then((data) => {
              alert(data.mensaje);
              cerrarModalAltaEmpleado();
              location.reload();
            })
            .catch((error) => {
              console.error("Error al insertar:", error);
              alert("Hubo un error al guardar el empleado: " + error.message);
            });
        });

      // Alternativa para manejar zona horaria
      function formatoFechaParaInput(fecha) {
        if (!fecha) return "";

        // Si ya está en formato YYYY-MM-DD
        if (typeof fecha === "string" && fecha.match(/^\d{4}-\d{2}-\d{2}$/)) {
          return fecha;
        }

        // Parsear fecha y ajustar por zona horaria
        const date = new Date(fecha);
        const offset = date.getTimezoneOffset();
        date.setMinutes(date.getMinutes() + offset);

        return date.toISOString().split("T")[0];
      }

      function editarEmpleado(id) {
        document
          .getElementById("edit-employee-modal")
          .classList.remove("hidden");

        fetch(`/api/empleado/${id}`)
          .then((res) => {
            if (!res.ok) throw new Error("Error al obtener datos del empleado");
            return res.json();
          })
          .then((data) => {
            Promise.all([
              fetch("/api/roles").then((res) => res.json()),
              fetch("/api/areas").then((res) => res.json()),
            ]).then(([roles, areas]) => {
              const selectRol = document.getElementById("edit-tipoRol");
              const selectArea = document.getElementById("edit-nombreArea");

              selectRol.innerHTML =
                '<option value="">Seleccione un rol</option>';
              roles.forEach((rol) => {
                const option = document.createElement("option");
                option.value = rol.idRol;
                option.textContent = rol.TipoRol;
                selectRol.appendChild(option);
              });

              selectArea.innerHTML =
                '<option value="">Seleccione un área</option>';
              areas.forEach((area) => {
                const option = document.createElement("option");
                option.value = area.idArea;
                option.textContent = area.NombreArea;
                selectArea.appendChild(option);
              });

              document.getElementById("edit-idUsuario").value =
                data.idUsuario || "";
              document.getElementById("edit-tipoRol").value =
                data.Rol_idRol || "";
              document.getElementById("edit-nombreArea").value =
                data.Area_idArea || "";
              document.getElementById("edit-nombres").value =
                data.Nombres || "";
              document.getElementById("edit-paterno").value =
                data.Paterno || "";
              document.getElementById("edit-materno").value =
                data.Materno || "";
              document.getElementById("edit-fechaNacimiento").value =
                formatoFechaParaInput(data.FechaNacimiento);
              document.getElementById("edit-direccion").value =
                data.Direccion || "";
              document.getElementById("edit-codigoPostal").value =
                data.CodigoPostal || "";
              document.getElementById("edit-correo").value = data.Correo || "";
              document.getElementById("edit-nss").value = data.NSS || "";
              document.getElementById("edit-telefono").value =
                data.Telefono || "";
              document.getElementById("edit-fechaIngreso").value =
                formatoFechaParaInput(data.FechaIngreso);
              document.getElementById("edit-rfc").value = data.RFC || "";
              document.getElementById("edit-curp").value = data.Curp || "";
              document.getElementById("edit-puesto").value = data.Puesto || "";
              document.getElementById("edit-nombreContactoEmergencia").value =
                data.NombreContactoEmergencia || "";
              document.getElementById("edit-telefonoEmergencia").value =
                data.TelefonoEmergencia || "";
              document.getElementById("edit-parentesco").value =
                data.Parentesco || "";
              document.getElementById("edit-contraseña").value =
                data.clave || "";
              document.getElementById("edit-confirmarContraseña").value =
                data.clave || "";
              document.getElementById("edit-sueldoDiario").value =
                data.SueldoDiario || "";
              document.getElementById("edit-sueldoSemanal").value =
                data.SueldoSemanal || "";
              document.getElementById("edit-bonoSemanal").value =
                data.BonoSemanal || "";
              document.getElementById("edit-fechaBaja").value =
                formatoFechaParaInput(data.FechaBaja);
              document.getElementById("edit-comentarioSalida").value =
                data.ComentarioSalida || "";
            });
          })
          .catch((error) => {
            console.error("Error al cargar datos del empleado:", error);
            alert("No se pudieron cargar los datos del empleado.");
          });
      }

      function cerrarModalEditarEmpleado() {
        document.getElementById("edit-employee-modal").classList.add("hidden");
      }

      function buscarEmpleado() {
        const termino = document
          .getElementById("busquedaEmpleado")
          .value.toLowerCase();

        fetch("/api/empleados")
          .then((res) => res.json())
          .then((empleados) => {
            const resultados = empleados.filter(
              (emp) =>
                emp.id.toString().includes(termino) ||
                emp.nombre.toLowerCase().includes(termino)
            );

            const tbody = document.getElementById("empleados-body");
            tbody.innerHTML = "";

            if (resultados.length === 0) {
              tbody.innerHTML = `<tr><td colspan="4">No se encontraron empleados</td></tr>`;
            } else {
              resultados.forEach((emp) => {
                const row = document.createElement("tr");
                row.innerHTML = `
            <td>${emp.id}</td>
            <td>${emp.nombre}</td>
            <td>${emp.puesto}</td>
            <td>
              <button class="action-btn" onclick="verEmpleado(${emp.id})">
                <i class="bi bi-eye"></i>
              </button>
              <button class="action-btn" onclick="editarEmpleado(${emp.id})">
                <i class="bi bi-pencil"></i>
              </button>
              <button class="action-btn" onclick="eliminarEmpleado(${emp.id})">
                <i class="bi bi-trash"></i>
              </button>
            </td>
          `;
                tbody.appendChild(row);
              });
            }
          })
          .catch((error) => {
            console.error("Error en búsqueda:", error);
          });
      }

      document
        .getElementById("edit-employee-form")
        .addEventListener("submit", function (e) {
          e.preventDefault();

          const contraseña = document.getElementById("edit-contraseña").value;
          const confirmar = document.getElementById(
            "edit-confirmarContraseña"
          ).value;

          if (contraseña !== confirmar) {
            alert("Las contraseñas no coinciden");
            return;
          }

          const empleadoData = {
            idUsuario: Number(document.getElementById("edit-idUsuario").value),
            rol_id: document.getElementById("edit-tipoRol").value,
            area_id: document.getElementById("edit-nombreArea").value,
            nombres: document.getElementById("edit-nombres").value,
            paterno: document.getElementById("edit-paterno").value,
            materno: document.getElementById("edit-materno").value,
            fechaNacimiento: document.getElementById("edit-fechaNacimiento")
              .value,
            direccion: document.getElementById("edit-direccion").value,
            codigoPostal: document.getElementById("edit-codigoPostal").value,
            correo: document.getElementById("edit-correo").value,
            nss: Number(document.getElementById("edit-nss").value),
            telefono: Number(document.getElementById("edit-telefono").value),
            fechaIngreso: document.getElementById("edit-fechaIngreso").value,
            rfc: document.getElementById("edit-rfc").value,
            curp: document.getElementById("edit-curp").value,
            puesto: document.getElementById("edit-puesto").value,
            nombreContactoEmergencia: document.getElementById(
              "edit-nombreContactoEmergencia"
            ).value,
            telefonoEmergencia: Number(
              document.getElementById("edit-telefonoEmergencia").value
            ),
            parentesco: document.getElementById("edit-parentesco").value,
            contraseña: contraseña,
            SueldoDiario: Number(
              document.getElementById("edit-sueldoDiario").value
            ),
            SueldoSemanal: Number(
              document.getElementById("edit-sueldoSemanal").value
            ),
            BonoSemanal: Number(
              document.getElementById("edit-bonoSemanal").value
            ),
            fechaBaja: document.getElementById("edit-fechaBaja").value || null,
            comentarioSalida:
              document.getElementById("edit-comentarioSalida").value || null,
          };

          fetch(`/api/empleado/${empleadoData.idUsuario}`, {
            method: "PUT",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify(empleadoData),
          })
            .then((res) => {
              if (!res.ok) throw new Error("Error al actualizar el empleado");
              return res.json();
            })
            .then((data) => {
              alert(data.mensaje);
              cerrarModalEditarEmpleado();
              location.reload();
            })
            .catch((err) => {
              console.error("Error:", err);
              alert("Hubo un error al actualizar: " + err.message);
            });
        });

      // Campos disponibles para exportación
      const camposExportacion = [
        { id: "idUsuario", nombre: "ID Usuario" },
        { id: "TipoRol", nombre: "Tipo de Rol" },
        { id: "NombreArea", nombre: "Área" },
        { id: "Nombres", nombre: "Nombres" },
        { id: "Paterno", nombre: "Apellido Paterno" },
        { id: "Materno", nombre: "Apellido Materno" },
        { id: "FechaNacimiento", nombre: "Fecha Nacimiento" },
        { id: "Direccion", nombre: "Dirección" },
        { id: "CodigoPostal", nombre: "Código Postal" },
        { id: "Correo", nombre: "Correo Electrónico" },
        { id: "NSS", nombre: "Número de Seguro Social" },
        { id: "Telefono", nombre: "Teléfono" },
        { id: "FechaIngreso", nombre: "Fecha Ingreso" },
        { id: "RFC", nombre: "RFC" },
        { id: "Curp", nombre: "CURP" },
        { id: "Puesto", nombre: "Puesto" },
        { id: "NombreContactoEmergencia", nombre: "Contacto Emergencia" },
        { id: "TelefonoEmergencia", nombre: "Teléfono Emergencia" },
        { id: "Parentesco", nombre: "Parentesco" },
        { id: "FechaBaja", nombre: "Fecha Baja" },
        { id: "ComentarioSalida", nombre: "Comentario Salida" },
        { id: "Estado", nombre: "Estado" },
        { id: "SueldoDiario", nombre: "Sueldo Diario" },
        { id: "SueldoSemanal", nombre: "Sueldo Semanal" },
        { id: "BonoSemanal", nombre: "Bono Semanal" },
      ];

      function abrirModalExportarExcel() {
        document
          .getElementById("export-excel-modal")
          .classList.remove("hidden");

        const container = document.getElementById("export-fields-container");
        container.innerHTML = "";

        camposExportacion.forEach((campo) => {
          const div = document.createElement("div");
          div.style.display = "flex";
          div.style.alignItems = "center";
          div.style.gap = "8px";

          const checkbox = document.createElement("input");
          checkbox.type = "checkbox";
          checkbox.id = `export-${campo.id}`;
          checkbox.value = campo.id;
          checkbox.checked = true;

          const label = document.createElement("label");
          label.htmlFor = `export-${campo.id}`;
          label.textContent = campo.nombre;

          div.appendChild(checkbox);
          div.appendChild(label);
          container.appendChild(div);
        });
      }

      function cerrarModalExportarExcel() {
        document.getElementById("export-excel-modal").classList.add("hidden");
      }

      function exportarExcel() {
        // Obtener campos seleccionados
        const checkboxes = document.querySelectorAll(
          '#export-fields-container input[type="checkbox"]:checked'
        );
        const camposSeleccionados = Array.from(checkboxes).map(
          (cb) => cb.value
        );

        if (camposSeleccionados.length === 0) {
          alert("Por favor selecciona al menos un campo para exportar");
          return;
        }

        // Mostrar feedback de carga
        const exportBtn = document.querySelector(
          "#export-excel-modal .btn-primary"
        );
        const originalText = exportBtn.textContent;
        exportBtn.textContent = "Generando...";
        exportBtn.disabled = true;

        // Obtener datos de empleados
        fetch("/api/empleados")
          .then((response) => response.json())
          .then((empleados) => {
            if (!Array.isArray(empleados)) {
              throw new Error("La respuesta de /api/empleados no es válida");
            }

            // Obtener detalles completos de cada empleado
            const promises = empleados.map((emp) =>
              fetch(`/api/empleado/${emp.id}`).then((res) => res.json())
            );
            return Promise.all(promises);
          })
          .then((empleadosCompletos) => {
            // Preparar datos para Excel
            const datosExcel = empleadosCompletos.map((empleado) => {
              const fila = {};
              camposSeleccionados.forEach((campo) => {
                // Obtener valor
                let valor = empleado[campo];

                // Mapear campos especiales
                if (campo === "TipoRol") valor = empleado["TipoRol"] || "";
                if (campo === "NombreArea")
                  valor = empleado["NombreArea"] || "";

                // Formatear fechas
                if (
                  valor &&
                  (campo.includes("Fecha") ||
                    campo === "FechaNacimiento" ||
                    campo === "FechaIngreso" ||
                    campo === "FechaBaja")
                ) {
                  valor = new Date(valor).toLocaleDateString("es-MX");
                }

                // Buscar nombre de columna
                const campoObj = camposExportacion.find((c) => c.id === campo);
                fila[campoObj ? campoObj.nombre : campo] = valor || "";
              });
              return fila;
            });

            // Crear libro de Excel
            const wb = XLSX.utils.book_new();
            const ws = XLSX.utils.json_to_sheet(datosExcel);

            // Calcular anchos de columna
            const calcularAnchosColumnas = (worksheet) => {
              const range = XLSX.utils.decode_range(worksheet["!ref"]);
              const columnWidths = [];

              for (let C = range.s.c; C <= range.e.c; ++C) {
                let maxLength = 0;

                // Encabezado
                const headerCell =
                  worksheet[XLSX.utils.encode_cell({ r: range.s.r, c: C })];
                if (headerCell && headerCell.v) {
                  maxLength = headerCell.v.toString().length;
                }

                // Datos
                for (let R = range.s.r + 1; R <= range.e.r; ++R) {
                  const cell =
                    worksheet[XLSX.utils.encode_cell({ r: R, c: C })];
                  if (cell && cell.v) {
                    const cellLength = cell.v.toString().length;
                    if (cellLength > maxLength) {
                      maxLength = cellLength;
                    }
                  }
                }

                columnWidths.push({
                  wch: Math.min(Math.max(maxLength, 10), 50), // entre 10 y 50 caracteres
                });
              }

              return columnWidths;
            };

            ws["!cols"] = calcularAnchosColumnas(ws);

            // Estilo de encabezado
            const headerStyle = {
              font: { bold: true, color: { rgb: "FFFFFF" } },
              fill: { fgColor: { rgb: "2C3E50" } },
              alignment: { horizontal: "center" },
            };

            // Aplicar estilo a encabezados
            const range = XLSX.utils.decode_range(ws["!ref"]);
            for (let C = range.s.c; C <= range.e.c; ++C) {
              const cellAddress = XLSX.utils.encode_cell({
                r: range.s.r,
                c: C,
              });
              if (!ws[cellAddress].s) ws[cellAddress].s = {};
              Object.assign(ws[cellAddress].s, headerStyle);
            }

            // Agregar hoja y generar archivo
            XLSX.utils.book_append_sheet(wb, ws, "Empleados");

            const fecha = new Date()
              .toLocaleDateString("es-MX", {
                day: "2-digit",
                month: "2-digit",
                year: "numeric",
              })
              .replace(/\//g, "-");

            XLSX.writeFile(wb, `Reporte_Empleados_${fecha}.xlsx`);

            cerrarModalExportarExcel();
          })
          .catch((error) => {
            console.error("Error al exportar a Excel:", error);
            alert(
              "Ocurrió un error al generar el archivo Excel: " + error.message
            );
          })
          .finally(() => {
            exportBtn.textContent = originalText || "Exportar a Excel";
            exportBtn.disabled = false;
          });
      }

      function mostrarModalConfirmacion({ 
  texto, 
  textoBotonConfirmar = 'Confirmar', 
  claseBotonConfirmar = 'btn-danger', 
  onConfirmar, 
  onCancelar 
}) {
  const modal = document.getElementById('modal-confirmacion');
  const modalTexto = document.getElementById('modal-texto');
  const btnConfirmar = document.getElementById('modal-confirmar');
  const btnCancelar = document.getElementById('modal-cancelar');

  modalTexto.textContent = texto;

  // Cambiar texto y clases del botón confirmar
  btnConfirmar.textContent = textoBotonConfirmar;
  btnConfirmar.className = 'btn ' + claseBotonConfirmar;

  modal.classList.remove('hidden');

  // Remover listeners previos
  btnConfirmar.onclick = null;
  btnCancelar.onclick = null;

  btnConfirmar.onclick = () => {
    if (typeof onConfirmar === 'function') onConfirmar();
    modal.classList.add('hidden');
  };

  btnCancelar.onclick = () => {
    if (typeof onCancelar === 'function') onCancelar();
    modal.classList.add('hidden');
  };
}

function mostrarModalExito() {
  const modal = document.getElementById('modal-exito');
  const btnCerrar = document.getElementById('btn-cerrar-exito');

  modal.classList.remove('hidden');

  btnCerrar.onclick = () => {
    modal.classList.add('hidden');
  };
}


    </script>
  </body>
</html>
